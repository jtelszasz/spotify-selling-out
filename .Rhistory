knitr::opts_chunk$set(
echo = F,
warning = F,
message = F,
include = T,
cache = F,
fig.width = 6,
fig.height = 4,
out.width = "100%",
out.height = "100%"
)
knitr::clean_cache(
clean = FALSE,
path = knitr::opts_chunk$get("cache.path")
)
library(tidyverse)
library(lubridate)
library(sf)
library(leaflet)
library(ggiteam)
library(kableExtra)
library(htmltools)
library(DT)
df <- read_csv("data/data/track_features/tf_mini.csv")
head(df)
View(df)
track_features <- read_csv("data/data/track_features/tf_mini.csv")
track_features <- read_csv("data/data/track_features/tf_mini.csv")
track_features <- read_csv("../data/data/track_features/tf_mini.csv")
skips <- read_csv("../data/training_set/log_mini.csv")
skips <- read_csv("../data/data/training_set/log_mini.csv")
View(skips)
full <- skips %>% left_join(track_features, by = c("track_id_clean" = "track_id"))
View(full)
remove(df)
knitr::opts_chunk$set(
echo = F,
warning = F,
message = F,
include = T,
cache = F,
fig.width = 6,
fig.height = 4,
out.width = "100%",
out.height = "100%"
)
knitr::clean_cache(
clean = FALSE,
path = knitr::opts_chunk$get("cache.path")
)
library(tidyverse)
library(lubridate)
library(sf)
library(leaflet)
library(ggiteam)
library(kableExtra)
library(htmltools)
library(DT)
track_features <- read_csv("../data/data/track_features/tf_mini.csv")
skips <- read_csv("../data/data/training_set/log_mini.csv")
full <- skips %>% left_join(track_features, by = c("track_id_clean" = "track_id"))
full %>%
group_by(not_skipped) %>%
summarise(mean(energy))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n()) %>%
head()
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n()) %>%
arrange(desc(plays))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n()) %>%
filter(plays >= 30) %>%
arrange(desc(plays))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 30) %>%
arrange(desc(plays))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 30) %>%
arrange(desc(plays)) %>%
mutate(not_skipped_pct = not_skipped / plays)
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 30) %>%
mutate(not_skipped_pct= not_skipped / plays)  %>%
arrange(desc(plays))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 30) %>%
mutate(not_skipped_pct= not_skipped / plays)  %>%
arrange(desc(not_skipped_pct))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 100) %>%
mutate(not_skipped_pct= not_skipped / plays)  %>%
arrange(desc(not_skipped_pct))
skips %>%
group_by(track_id_clean) %>%
summarise(plays = n(),
not_skipped = sum(not_skipped)) %>%
filter(plays >= 50) %>%
mutate(not_skipped_pct= not_skipped / plays)  %>%
arrange(desc(not_skipped_pct))
View(track_features)
View(skips)
remove(full)
View(skips)
skips %>%
count(track_id_clean) %>%
arrange(desc(n))
skips %>%
count(track_id_clean) %>%
arrange(n)
skips %>%
count(track_id_clean) %>%
count(n == 1)
skips %>%
count(track_id_clean) %>%
arrange(desc(n))
track_plays_and_skips <- skips %>%
group_by(track_id_clean) %>%
summarise(
plays = n(),
not_skipped = sum(not_skipped)
) %>%
filter(plays >= 50) %>%
mutate(not_skipped_pct= not_skipped / plays)
View(track_features)
View(track_plays_and_skips)
View(track_features)
track_plays_and_skips %>%
left_join(track_features, by = c("track_id_clean" = "track_id")) %>%
head()
track_plays_skips_features <- track_plays_and_skips %>%
left_join(track_features, by = c("track_id_clean" = "track_id"))
View(track_plays_skips_features)
track_plays_and_skips <- skips %>%
group_by(track_id_clean) %>%
summarise(
plays = n(),
skip_1 = sum(skip_1),
skip_2 = sum(skip_2),
skip_3 = sum(skip_3),
not_skipped = sum(not_skipped)
) %>%
filter(plays >= 50) %>%
mutate(not_skipped_pct= not_skipped / plays)
track_plays_skips_features <- track_plays_and_skips %>%
left_join(track_features, by = c("track_id_clean" = "track_id"))
View(track_plays_skips_features)
track_plays_skips_features %>%
group_by(not_skipped) %>%
summarise(mean(energy))
View(track_plays_skips_features)
View(skips)
track_plays_skips_features %>%
ggplot(aes(x = energy, y = not_skipped_pct)) +
geom_point()
View(track_plays_skips_features)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = not_skipped_pct)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = not_skipped_pct, -not_skipped_pct)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = not_skipped_pct, value = not_skipped_pct)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = not_skipped_pct, value = metric)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = metric_name, value = metric)
ggplot(aes(x = energy, y = not_skipped_pct)) +
geom_point()
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = metric_name, value = metric)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = metric_name, value = metric, -not_skipped_pct)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability
) %>%
gather(key = metric_name, value = metric, -not_skipped_pct) %>%
ggplot(aes(x = metric, y = not_skipped_pct)) +
geom_point() +
facet_wrap(~metric_name)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability,
flatness,
instrumentalness
) %>%
gather(key = metric_name, value = metric, -not_skipped_pct) %>%
ggplot(aes(x = metric, y = not_skipped_pct)) +
geom_point() +
facet_wrap(~metric_name)
View(track_plays_skips_features)
View(track_features)
View(skips)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability,
flatness,
instrumentalness
) %>%
gather(key = metric_name, value = metric, -not_skipped_pct) %>%
ggplot(aes(x = metric, y = not_skipped_pct)) +
geom_point() +
facet_wrap(~metric_name)
track_plays_skips_features %>%
select(
not_skipped_pct,
energy,
bounciness,
beat_strength,
danceability,
flatness,
instrumentalness
) %>%
gather(key = metric_name, value = metric, -not_skipped_pct) %>%
ggplot(aes(x = metric, y = not_skipped_pct)) +
geom_point() +
facet_wrap(~metric_name)
View(skips)
View(skips)
